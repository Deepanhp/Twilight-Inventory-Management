<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || "Om Sakthi Hydraulics Inventory Management" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <link rel="manifest" href="/manifest.json">
    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
    <%= stylesheet_link_tag    'application', media: 'all' %>
    <%= javascript_include_tag 'application'%>
    <%= stylesheet_link_tag "toastr.css" %>
    <%= stylesheet_link_tag "AdminLTE.min.css" %>
    <%= stylesheet_link_tag "admin-lte-all-skins.min.css" %>
    <%= stylesheet_link_tag "blue.css" %>
    <%= stylesheet_link_tag "dataTables.bootstrap.css" %>
    <%= stylesheet_link_tag "datepicker3.css" %>

    <%= stylesheet_link_tag "https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css" %>
    <%= stylesheet_link_tag "https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" %>
    <%= javascript_include_tag "https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"%>
    <%= javascript_include_tag "toastr.min.js" %>
    <%= javascript_include_tag "bootstrap3-wysihtml5.all.min.js"%>
    <%= javascript_include_tag "jquery.dataTables.min.js"%>
    <%= javascript_include_tag "dataTables.bootstrap.min.js"%>
    <%= javascript_include_tag "jquery.slimscroll.min.js"%>
    <%= javascript_include_tag "fastclick.js"%>
    <%= javascript_include_tag "admin-lte-app.min.js"%>
    <%= javascript_include_tag "icheck.min.js"%>
    <%= javascript_include_tag "bootstrap-datepicker.js"%>

    <!-- Select2 -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    
    <!-- AdminLTE and dependencies -->
    <%= stylesheet_link_tag "application" %>
    <%= stylesheet_link_tag "https://cdnjs.cloudflare.com/ajax/libs/admin-lte/2.4.18/css/AdminLTE.min.css" %>
    <%= stylesheet_link_tag "https://cdnjs.cloudflare.com/ajax/libs/admin-lte/2.4.18/css/skins/_all-skins.min.css" %>
    
    <!-- Font Awesome and Ionicons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">

    <!-- JavaScript dependencies -->
    <%= javascript_include_tag "application" %>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/2.4.18/js/adminlte.min.js"></script>

    <!-- Initialize AdminLTE -->
    <script>
      $(document).ready(function() {
        if ($.fn.select2) {
          $('.select2').select2();
        }
        
        if (typeof $.AdminLTE !== 'undefined' && typeof $.AdminLTE.layout !== 'undefined') {
          $.AdminLTE.layout.fix();
        }
      });
    </script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        body {
            background-color: #e3f2fd;
            color: #0d47a1;
            font-family: Arial, sans-serif;
            transition: background-color 0.3s ease-in-out;
        }
        .container {
            max-width: 1200px;
        }
        .card {
            border: 1px solid #0d6efd;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 255, 0.3);
            background: #ffffff;
            transition: box-shadow 0.3s ease-in-out;
        }
        .card:hover {
            box-shadow: 0 6px 20px rgba(0, 0, 255, 0.5);
        }
        .btn-primary {
            background-color: #0d6efd;
            border: none;
            transition: background-color 0.3s ease-in-out;
        }
        .btn-primary:hover {
            background-color: #0b5ed7;
        }
        .form-control {
            border: 1px solid #0d6efd;
            transition: border-color 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }
        .form-control:focus {
            border-color: #0b5ed7;
            box-shadow: 0 0 8px rgba(13, 110, 253, 0.5);
        }
        .form-select {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="%230d6efd"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/></svg>') no-repeat right 10px center;
            background-size: 16px;
            padding-right: 35px;
            border-radius: 5px;
            position: relative;
        }
        .table thead {
            background-color: #0d6efd;
            color: white;
        }
        .table-striped tbody tr:nth-of-type(odd) {
            background-color: #bbdefb;
        }
        .table-striped tbody tr:nth-of-type(even) {
            background-color: #e3f2fd;
        }
        .input-group {
            display: flex;
            align-items: center;
        }
        .input-group input {
            flex: 1;
        }
        .input-group-addon {
            padding: 6px 12px;
            background-color: #e3f2fd;
            border: 1px solid #0d6efd;
            border-left: none;
            border-radius: 0 5px 5px 0;
            color: #0d47a1;
            white-space: nowrap;
        }
        a {
            text-decoration: none;
        }
    </style>
  </head>

  <body class="hold-transition skin-blue sidebar-mini">
    <%= render 'layouts/notifications' %>
    <%= yield %>

    <%# <script type="text/javascript">
        document.addEventListener("DOMContentLoaded", function () {
        let dropdown = document.getElementById("company_id");

        // Set default value from localStorage if available
        let savedCompanyId = localStorage.getItem("company_id") || 1;
        if (savedCompanyId) {
            dropdown.value = savedCompanyId;
        } else {
            // Set a default value if none exists
            localStorage.setItem("company_id", dropdown.value);
        }

        // Update localStorage when user selects a new company
        dropdown.addEventListener("change", function () {
            localStorage.setItem("company_id", this.value);
        });
    });
    </script> %>
    <% if flash[:notice] == "Signed in successfully." %>
      <script>
        localStorage.setItem('company_id', '<%= current_user.company_id %>');
      </script>
    <% end %>
    <script type="text/javascript">
      document.addEventListener("DOMContentLoaded", function () {
        const storedValue = localStorage.getItem("company_id"); // Get value from localStorage
        if (storedValue) {
          let url = new URL(window.location);
          if (url.searchParams.get("company_id") !== storedValue) {
            url.searchParams.set("company_id", storedValue);
            window.history.replaceState({}, "", url.toString());
          }
        }
      });
    </script>
  </body>
</html>
